<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Chord Book</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé∏</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1>Interactive Chord Book</h1>
                <div class="search-section">
                    <div class="search-input-wrapper">
                        <input type="text" id="searchInput" class="search-input" placeholder="üîç Zoek op artiest of titel..." autocomplete="off">
                        <button id="clearSearchBtn" class="clear-search-btn hidden" title="Zoekveld legen">√ó</button>
                    </div>
                </div>
            </div>
            <div class="header-bar">
                <!-- Filters Section -->
                <div class="header-section filters-section">
                    <span class="section-label">Filter:</span>
                    <div class="filter-buttons">
                        <button id="filterAll" class="filter-btn active">Alle</button>
                        <button id="filterFavorites" class="filter-btn">‚≠ê Favorieten</button>
                    </div>
                </div>
                
                <!-- Setlist Management Section -->
                <div class="header-section setlist-section">
                    <span class="section-label">Setlist:</span>
                    <div class="setlist-controls">
                        <select id="setlistSelect" class="setlist-select">
                            <option value="">Alle Songs</option>
                        </select>
                        <button id="createSetlistBtn" class="setlist-btn" title="Nieuwe Setlist">+ Setlist</button>
                        <button id="deleteSetlistBtn" class="setlist-btn delete-setlist-btn hidden" title="Verwijder geselecteerde setlist">Verwijder</button>
                    </div>
                </div>
                
                <!-- Actions Section -->
                <div class="header-section actions-section">
                    <button id="addSongBtn" class="add-song-btn" title="Nieuwe Song Toevoegen">‚ûï</button>
                    <div class="import-export-controls">
                        <button id="exportBtn" class="import-export-btn" title="Exporteer">üì•</button>
                        <label for="importFile" class="import-export-btn" title="Importeer">üì§</label>
                        <input type="file" id="importFile" accept=".json" style="display: none;">
                        <button id="deleteAllSongsBtn" class="import-export-btn delete-all-btn" title="Verwijder alle songs">üóëÔ∏è</button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Selected song header - appears when a row is selected -->
        <div id="selectedSongHeader" class="selected-song-header hidden">
            <div class="selected-song-info">
                <span id="selectedArtist" class="selected-artist"></span>
                <span class="separator">-</span>
                <span id="selectedTitle" class="selected-title"></span>
            </div>
            <button id="deselectBtn" class="deselect-btn" title="Sluiten (Escape)">√ó</button>
        </div>
        
        <!-- Black overlay when row is selected -->
        <div id="selectionOverlay" class="selection-overlay hidden"></div>
        
        <!-- Focused view container for selected row -->
        <div id="focusedView" class="focused-view hidden">
            <div id="focusedTableWrapper" class="focused-table-wrapper">
                <!-- Selected row will be moved here -->
            </div>
        </div>
        
        <div class="table-wrapper">
            <table id="songsTable">
                <thead>
                    <tr>
                        <th class="sortable" data-column="artist">
                            Artiest
                            <span class="sort-indicator"></span>
                        </th>
                        <th class="sortable" data-column="title">
                            Songtitel
                            <span class="sort-indicator"></span>
                        </th>
                        <th class="sortable favorite-column" data-column="favorite">
                            ‚≠ê
                            <span class="sort-indicator"></span>
                        </th>
                        <th>Verse</th>
                        <th class="chorus-column">Chorus</th>
                        <th>Pre-Chorus</th>
                        <th>Bridge</th>
                        <th class="actions-column">Acties</th>
                    </tr>
                </thead>
                <tbody id="songsTableBody">
                    <!-- Songs will be dynamically inserted here -->
                </tbody>
            </table>
        </div>
        
    </div>
    
    <!-- Chord Selection Modal -->
    <div id="chordModal" class="chord-modal hidden">
        <div class="chord-modal-content">
            <div class="chord-modal-header">
                <h3>Selecteer Akkoorden</h3>
                <button class="chord-modal-close" id="chordModalClose">&times;</button>
            </div>
            <div class="chord-modal-body">
                <div class="chord-categories">
                    <div class="chord-category">
                        <h4>Majeur</h4>
                        <div class="chord-buttons" id="majorChords"></div>
                    </div>
                    <div class="chord-category">
                        <h4>Mineur</h4>
                        <div class="chord-buttons" id="minorChords"></div>
                    </div>
                    <div class="chord-category toggleable" id="susAddCategory">
                        <div class="chord-category-header">
                            <h4>Sus & Add</h4>
                            <button class="toggle-category-btn" id="toggleSusAdd">Toon</button>
                        </div>
                        <div class="chord-buttons hidden" id="susAddChords"></div>
                    </div>
                    <div class="chord-category toggleable" id="specialCategory">
                        <div class="chord-category-header">
                            <h4>Speciale</h4>
                            <button class="toggle-category-btn" id="toggleSpecial">Toon</button>
                        </div>
                        <div class="chord-buttons hidden" id="specialChords"></div>
                    </div>
                </div>
                <div class="chord-input-section">
                    <label>Of typ zelf akkoorden:</label>
                    <input type="text" id="chordCustomInput" placeholder="Bijv: C G Am F" />
                    <button id="chordAddCustom" class="chord-add-btn">Toevoegen</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Setlist Modal -->
    <div id="setlistModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nieuwe Setlist</h3>
                <button class="modal-close" id="setlistModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="setlistNameInput" placeholder="Setlist naam..." />
                <button id="setlistCreateBtn" class="modal-submit-btn">Aanmaken</button>
            </div>
        </div>
    </div>
    
    <!-- Add Songs to Setlist Modal -->
    <div id="addSongsToSetlistModal" class="modal hidden">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="addSongsModalTitle">Songs toevoegen aan setlist</h3>
                <button class="modal-close" id="addSongsModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="songs-selection-container">
                    <div class="selection-controls">
                        <button id="selectAllSongs" class="selection-btn">Alles selecteren</button>
                        <button id="deselectAllSongs" class="selection-btn">Alles deselecteren</button>
                        <span id="selectedCount" class="selected-count">0 geselecteerd</span>
                    </div>
                    <div class="songs-list" id="songsListContainer">
                        <!-- Songs will be dynamically inserted here -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button id="addSelectedSongsBtn" class="modal-submit-btn">Geselecteerde songs toevoegen</button>
                    <button id="cancelAddSongsBtn" class="modal-cancel-btn">Annuleren</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Song Detail Modal -->
    <div id="songDetailModal" class="song-detail-modal hidden">
        <div class="song-detail-modal-content">
            <div class="song-detail-header">
                <button class="song-detail-nav-btn song-detail-prev" id="songDetailPrev" title="Vorige song">‚Äπ</button>
                <div class="song-detail-title-section">
                    <h2 id="songDetailArtist" class="song-detail-artist"></h2>
                    <span class="song-detail-separator">-</span>
                    <h1 id="songDetailTitle" class="song-detail-title"></h1>
                </div>
                <div class="song-detail-header-right">
                    <button class="song-detail-nav-btn song-detail-next" id="songDetailNext" title="Volgende song">‚Ä∫</button>
                    <button class="song-detail-close" id="songDetailModalClose">&times;</button>
                </div>
            </div>
            <div class="song-detail-body">
                <div class="song-chord-section" id="verseSection">
                    <h3 class="chord-section-title">Verse</h3>
                    <div class="chord-section-content" id="verseContent"></div>
                </div>
                <div class="song-chord-section" id="preChorusSection">
                    <h3 class="chord-section-title">Pre-Chorus</h3>
                    <div class="chord-section-content" id="preChorusContent"></div>
                </div>
                <div class="song-chord-section chorus-section" id="chorusSection">
                    <h3 class="chord-section-title">Chorus</h3>
                    <div class="chord-section-content" id="chorusContent"></div>
                </div>
                <div class="song-chord-section" id="bridgeSection">
                    <h3 class="chord-section-title">Bridge</h3>
                    <div class="chord-section-content" id="bridgeContent"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Chord Detector Overlay -->
    <div id="chordDetectorOverlay" class="chord-detector-overlay">
        <div class="chord-detector-content">
            <div class="chord-detector-header">
                <h3>Akkoord Detectie</h3>
                <div class="chord-detector-header-buttons">
                    <button id="chordDetectorMinimize" class="chord-detector-minimize-btn" title="Minimaliseer">üîª</button>
                </div>
            </div>
            <div class="chord-detector-body">
                <div class="chord-display">
                    <div id="detectedChord" class="detected-chord-display">--</div>
                    <div id="chordDetectorStatus" class="chord-detector-status">Niet actief</div>
                    <div class="audio-level-container">
                        <div class="audio-level-label">Geluid:</div>
                        <div class="audio-level-bar">
                            <div id="audioLevelIndicator" class="audio-level-indicator"></div>
                        </div>
                    </div>
                </div>
                <button id="chordDetectorToggle" class="chord-detector-toggle-btn" title="Start detectie">üé§</button>
                <select id="microphoneSelect" class="microphone-select" title="Kies microfoon"></select>
            </div>
        </div>
    </div>
    
    <!-- Models -->
    <script src="js/models/SongManager.js"></script>
    <script src="js/models/SetlistManager.js"></script>
    <!-- Utils -->
    <script src="js/utils/Sorter.js"></script>
    <script src="js/utils/ChordDetector.js"></script>
    <!-- UI Components -->
    <script src="js/ui/ChordModal.js"></script>
    <script src="js/ui/SongDetailModal.js"></script>
    <script src="js/ui/TableRenderer.js"></script>
    <script src="js/ui/ChordDetectorOverlay.js"></script>
    <!-- Main App -->
    <script src="js/app.js"></script>
</body>
</html>

